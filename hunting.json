{"category": "Onboarding", "blockly": false, "labels": ["*"], "blockly_xml": "<xml></xml>", "coa": {"version": "1.0", "data": {"joint": {"cells": [{"target": {"id": "954fd291-77be-4003-97f1-3bd67aeba3d1", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 29, "type": "link", "id": "315af088-3a09-4dac-9cdd-523230e67e72"}, {"target": {"id": "0f084c8f-0d50-4a5a-8b1a-e0a0f56acb7c", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 58, "type": "link", "id": "22d7cedc-9626-4c98-a3ea-c8dd4c6f2b2f"}, {"target": {"id": "4ba1f991-42c7-440e-bf58-a3d5d9726dc9", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 77, "type": "link", "id": "2d980c60-da05-4309-8aec-5551e3f3fee7"}, {"target": {"id": "c27d207a-ca0b-4447-bb2f-e521d574d01a", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 91, "type": "link", "id": "b994bd06-625c-4e6d-bc9f-36b52d5683b2"}, {"target": {"id": "21473efc-e092-47f7-b7b9-7da11c863b83", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 183, "type": "link", "id": "7badf22b-ba9e-4c84-883b-defec9fdf1f6"}, {"target": {"id": "9f724d77-827a-405b-ae3f-455694a9e71b", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "4ba1f991-42c7-440e-bf58-a3d5d9726dc9", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 259, "type": "link", "id": "7d9f96f4-dd8a-491a-933b-3b8338757249"}, {"target": {"port": "in", "id": "9f724d77-827a-405b-ae3f-455694a9e71b", "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "954fd291-77be-4003-97f1-3bd67aeba3d1", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 300, "type": "link", "id": "86506df2-676e-401f-a683-aafa9bccc735"}, {"target": {"id": "eeb14016-24e5-4d21-9f85-3e807b8af8e9", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "b394e8d2-7451-4d35-b39b-a7be5208b783", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 346, "type": "link", "id": "950b5beb-5f2e-4ac4-b866-c629bf780097"}, {"target": {"id": "013ad619-fc1e-4d99-b8c3-cf6d903a7418", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "0f084c8f-0d50-4a5a-8b1a-e0a0f56acb7c", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 669, "type": "link", "id": "86f95962-ad9b-4854-af76-fb049739f3e7"}, {"target": {"id": "4a162014-04b2-4c5f-a07c-e8a45878f05f", "selector": ".port-body[type=\"input\"]"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": "out-1", "id": "013ad619-fc1e-4d99-b8c3-cf6d903a7418", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 684, "type": "link", "id": "7bd03bd1-1474-4d21-8458-e3b20486a24e"}, {"target": {"port": null, "id": "b394e8d2-7451-4d35-b39b-a7be5208b783", "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": "out-1", "id": "9f724d77-827a-405b-ae3f-455694a9e71b", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 824, "type": "link", "id": "126ce1e2-d45d-440e-adae-40058a099f2a"}, {"target": {"port": null, "id": "eb486af3-0bc0-4a83-9311-9d6f7d01e8d8", "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"}, "startDirections": ["right"], "connector": {"args": {"radius": 5}, "name": "rounded"}, "source": {"port": null, "id": "eeb14016-24e5-4d21-9f85-3e807b8af8e9", "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"}, "endDirections": ["left"], "attrs": {".marker-target": {"stroke": "#6a6c8a", "d": "M 10 0 L 0 5 L 10 10 z", "fill": "#6a6c8a"}, ".connection": {"stroke": "#6C7A89", "stroke-width": 2}, ".tool-remove": {"position": 0.5}}, "router": {"name": "metro"}, "z": 1175, "type": "link", "id": "ea7ffd8a-9922-454b-8045-07920827e876"}, {"custom_code": "", "number": 2, "outPorts": ["out-1"], "attrs": {"g.error": {"opacity": 0}, ".border": {"stroke": "#5094D4", "transform": "rotate(45 30 70)"}, ".inPorts>.port-0>.port-body": {"port": {"type": "in", "id": "in"}}, ".outPorts>.port-0": {"ref-y": 40, "port": {"type": "out", "id": "out-1"}, "ref-x": 83}, ".number": {"text": 2}, ".outPorts>.port-0>.port-body": {"port": {"type": "out", "id": "out-1"}}, ".background": {"transform": "rotate(45 30 70)"}}, "id": "013ad619-fc1e-4d99-b8c3-cf6d903a7418", "size": {"width": 82, "height": 82}, "connection_type": "action", "connected_to_start": false, "parameters": [{"fields": {"hunt_domain_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "hunt_domain_1:artifact:*.cef.request": {"contains": [], "type": "string"}}, "name": "hunt_domain_1 inputs"}, {"fields": {"hunt_domain_1:action_result.data.*.device_id": {"contains": ["falcon device id"]}, "hunt_domain_1:action_result.parameter.domain": {"contains": ["domain"]}, "hunt_domain_1:action_result.parameter.count_only": {"contains": []}, "hunt_domain_1:action_result.status": {"contains": []}, "hunt_domain_1:action_result.summary.device_count": {"contains": []}}, "name": "hunt_domain_1 results"}, {"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "inPorts": ["in"], "state": "decision", "hasElse": false, "type": "coa.Decision", "status": "", "outputs": [{"type": "if", "conditions": [{"comparison": ">=", "param": "hunt_domain_1:action_result.parameter.count_only", "value": "1", "data_type": ""}], "display": "If", "logic": "and"}], "previous_block_type": "", "warn": "", "active": false, "angle": 0, "name": "", "custom_name": "", "connection_name": "hunt domain", "position": {"y": 20, "x": 680}, "z": 2518}, {"status": "", "warn": false, "z": 2539, "connected_to_start": true, "name": "", "title": "END", "custom_code": "def on_finish(container, summary):\n\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all detals of actions \n    # can be collected here.\n\n    ip_actions = []\n    domain_actions = []\n    file_actions = []\n    hunt_actions = []\n    query_actions = []\n    \n    # ip actions\n    ip_actions.append('whois ip')\n    \n    #domain actions\n    domain_actions.append('whois domain')\n    \n    #file actions\n    file_actions.append('file reputation')\n    file_actions.append('detonate file')\n    \n    #hunting actions\n    hunt_actions.append('hunt file')\n    hunt_actions.append('hunt domain')\n    \n    # query actions\n    query_actions.append('run query')\n\n    summary_json = phantom.get_summary()\n    if 'result' in summary_json:\n\n        for action_result in summary_json['result']:\n\n            if 'action_run_id' in action_result:\n\n                action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=True, flatten=False)\n                if action_results:\n\n                    if action_results[0]['action'] in ip_actions:\n                        data = is_bad_ip(action_results)\n                        for item in data:\n                            if item['bad'] == True:\n                                escalate(container)\n                                return\n\n                    if action_results[0]['action'] in domain_actions:\n                        data = is_bad_domain(action_results)\n                        for item in data:\n                            if item['bad'] == True:\n                                escalate(container)\n                                return\n\n                    if action_results[0]['action'] in file_actions:\n                        data = is_bad_file(action_results)\n                        for item in data:\n                            if item['bad'] == True:\n                                escalate(container)\n                                return\n\n                    if action_results[0]['action'] in hunt_actions:\n                        data = is_present(action_results)\n                        for item in data:\n                            if item['bad'] == True:\n                                escalate(container)\n                                return   \n\n                    if action_results[0]['action'] in query_actions:\n                        data = is_positive_query(action_results)\n                        for item in data:\n                            if item['bad'] == True:\n                                escalate(container)\n                                return                                \n    return", "inPorts": ["in"], "connection_name": "detonate file", "connection_type": "action", "1": "N", "0": "E", "2": "D", "outPorts": [], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#FFFFFF"}, ".title": {"text": "END"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"color": "#FFFFFF"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}}, "active": false, "position": {"y": 340, "x": 1300}, "angle": 0, "type": "coa.StartEnd", "id": "eb486af3-0bc0-4a83-9311-9d6f7d01e8d8", "size": {"width": 96, "height": 48}}, {"showNumber": false, "custom_code": "def get_device_info_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"get device info\")\n    \n    if not assets:\n        return\n\n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_device_info_1' call\n    filtered_container_data = phantom.collect2(container=container, datapath=['filtered-artifact:*.cef.deviceAddress', 'filtered-artifact:*.id'], filter_artifacts=filtered_artifacts)\n\n    parameters = []\n    \n    # build parameters list for 'get_device_info_1' call\n    for filtered_container_item in filtered_container_data:\n        if filtered_container_item[0]:\n            parameters.append({\n                'ip_hostname': filtered_container_item[0],\n            })\n\n    if parameters:\n        phantom.act(\"get device info\", parameters=parameters, assets=assets, name=\"get_device_info_1\")    \n    \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "get device info"}}, "reviewer": "", "message": "", "id": "4a162014-04b2-4c5f-a07c-e8a45878f05f", "size": {"width": 168, "height": 112}, "connection_type": "action", "previous_name": "get_device_info_1", "connected_to_start": false, "parameters": [{"fields": {"filtered-artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.request": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.msg": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.in": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.startTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "filtered-artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "filtered-artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "filtered-artifact:*.cef.start": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "filtered-artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.app": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.cn1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileType": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.suid": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.cs2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cnt": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "filtered-artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.outcome": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.spriv": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.act": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs6": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs5": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs4": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.proto": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.out": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fsize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.rt": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.end": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.message": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.endTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cat": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.duid": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.externalId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}}, "name": "decision_2 filtered artifacts"}, {"fields": {"hunt_domain_1:filtered-action_result.parameter.count_only": {"contains": []}, "hunt_domain_1:filtered-action_result.data.*.device_id": {"contains": ["falcon device id"]}, "hunt_domain_1:filtered-action_result.parameter.domain": {"contains": ["domain"]}, "hunt_domain_1:filtered-action_result.status": {"contains": []}, "hunt_domain_1:filtered-action_result.summary.device_count": {"contains": []}}, "name": "hunt_domain_1 filtered results"}, {"fields": {"hunt_domain_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "hunt_domain_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_domain_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_domain_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "hunt_domain_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "hunt_domain_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_domain_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "hunt_domain_1:artifact:*.cef.request": {"contains": [], "type": "string"}}, "name": "hunt_domain_1 inputs"}, {"fields": {"hunt_domain_1:action_result.data.*.device_id": {"contains": ["falcon device id"]}, "hunt_domain_1:action_result.parameter.domain": {"contains": ["domain"]}, "hunt_domain_1:action_result.parameter.count_only": {"contains": []}, "hunt_domain_1:action_result.status": {"contains": []}, "hunt_domain_1:action_result.summary.device_count": {"contains": []}}, "name": "hunt_domain_1 results"}, {"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"ip_hostname": "filtered-artifact:*.cef.deviceAddress"}, "active_keys": {}, "assets": [{"fields": {"ip_hostname": "filtered-artifact:*.cef.deviceAddress"}, "type": "endpoint", "name": "mfeepo_1", "output": [{"column_name": "ePO Server", "contains": ["host name", "ip"], "data_path": "action_result.data.*.EPO_IP/Hostname", "data_type": "string", "column_order": 0}, {"column_name": "Port", "contains": ["port"], "data_path": "action_result.data.*.EPO_Port", "data_type": "string", "column_order": 1}, {"column_name": "Host", "contains": ["host name", "ip"], "data_path": "action_result.parameter.ip_hostname", "data_type": "string", "column_order": 2}, {"column_name": "Tags", "contains": ["mfeeop tag"], "data_path": "action_result.data.*.EPOLeafNode_Tags.*.Tag", "data_type": "string", "column_order": 3}, {"data_path": "action_result.data.*.EPOBranchNode_AutoID", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOLeafNode_ExcludedTags", "data_type": "string"}, {"data_path": "action_result.data.*.EPOLeafNode_ManagedState", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOLeafNode_AgentVersion", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOLeafNode_LastUpdate", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOLeafNode_AgentGUID", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_Vdi", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSType", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_CPUType", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSOEMID", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_CPUSpeed", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_NumOfCPU", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_ParentID", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_TimeZone", "data_type": "string"}, {"contains": ["user name"], "data_path": "action_result.data.*.EPOComputerProperties_UserName", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPAddress", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSBitMode", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSVersion", "data_type": "string"}, {"contains": ["domain"], "data_path": "action_result.data.*.EPOComputerProperties_DomainName", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_FreeMemory", "data_type": "numeric"}, {"contains": ["host name", "ip"], "data_path": "action_result.data.*.EPOComputerProperties_IPHostName", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPXAddress", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_IsPortable", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_NetAddress", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSBuildNum", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSPlatform", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_SubnetMask", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_CPUSerialNum", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_ComputerName", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_DefaultLangID", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_FreeDiskSpace", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_SubnetAddress", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_TotalDiskSpace", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_SysvolFreeSpace", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_OSServicePackVer", "data_type": "string"}, {"data_path": "action_result.data.*.EPOComputerProperties_SysvolTotalSpace", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_TotalPhysicalMemory", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPSubnetMask", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPSubnet", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_LastAgentHandler", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_UserProperty1", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_UserProperty2", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_UserProperty3", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_UserProperty4", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPV4x", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_IPV6", "data_type": "numeric"}, {"data_path": "action_result.data.*.EPOComputerProperties_Description", "data_type": "numeric"}, {"data_path": "action_result.status", "data_type": "string"}, {"data_path": "action_result.message", "data_type": "string"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}]}], "name": "get_device_info_1", "custom_name": "", "connection_name": "hunt domain", "action_type": "investigate", "action": "get device info", "position": {"y": 20, "x": 820}, "z": 2579}, {"showNumber": false, "custom_code": "def hunt_file_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"hunt file\", excluded_products=[\"AutoFocus\",\"ThreatScape\", \"CylancePROTECT\"])\n    if not assets:\n        return\n    \n    # collect data for 'hunt_file_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.fileHash', 'artifact:*.id'])\n\n    parameters = []\n    # build parameters list for 'hunt_file_1' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'hash': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    if parameters:\n        phantom.act(\"hunt file\", parameters=parameters, assets=assets, callback=join_decision_1, name=\"hunt_file_1\")    \n        \n    # Spec ial handling for Cylance since Cylance only uses SHA2 Hashes\n    assets=[]\n    cylance_parameters=[]\n    cylance_assets = phantom.get_assets(\"hunt file\")\n    for asset in assets:\n        if asset['product_name'].lower() == \"CylancePROTECT\".lower():\n            \n            assets=asset['name']\n            \n            for container_item in container_data:\n                if container_item[0]:\n                    if len(container_item[0]) == 64:\n                        cylance_parameters.append({\n                            'hash': container_item[0],\n                            # context (artifact id) is added to associate results with the artifact\n                            'context': {'artifact_id': container_item[1]},\n                        })\n            break\n            \n    if cylance_parameters:\n        phantom.act(\"hunt file\", parameters=parameters, assets=assets, callback=join_decision_1, name=\"hunt_file_1\")    \n\n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "hunt file"}}, "reviewer": "", "message": "", "id": "954fd291-77be-4003-97f1-3bd67aeba3d1", "size": {"width": 168, "height": 112}, "connection_type": "object", "previous_name": "hunt_file_1", "connected_to_start": true, "parameters": [{"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"hash": "artifact:*.cef.fileHash", "range": "", "type": ""}, "active_keys": {}, "assets": [{"fields": {"hash": "artifact:*.cef.fileHash"}, "type": "endpoint", "name": "cbprotect", "output": [{"data_path": "action_result.id", "data_type": "string"}, {"data_path": "action_result.data.*.id", "data_type": "numeric"}, {"data_path": "action_result.data.*.md5", "data_type": "string"}, {"data_path": "action_result.data.*.sha1", "data_type": "string"}, {"column_name": "Computer ID", "data_path": "action_result.data.*.computerId", "data_type": "string", "column_order": 1}, {"data_path": "action_result.data.*.trust", "data_type": "numeric"}, {"data_path": "action_result.data.*.sha256", "data_type": "string"}, {"data_path": "action_result.data.*.threat", "data_type": "numeric"}, {"column_name": "Company", "data_path": "action_result.data.*.company", "data_type": "string", "column_order": 3}, {"data_path": "action_result.data.*.category", "data_type": "string"}, {"column_name": "File Name", "data_path": "action_result.data.*.fileName", "data_type": "string", "column_order": 2}, {"data_path": "action_result.data.*.fileSize", "data_type": "numeric"}, {"data_path": "action_result.data.*.fileType", "data_type": "string"}, {"data_path": "action_result.data.*.pathName", "data_type": "string"}, {"data_path": "action_result.data.*.fileFlags", "data_type": "numeric"}, {"data_path": "action_result.data.*.fileState", "data_type": "numeric"}, {"data_path": "action_result.data.*.publisher", "data_type": "string"}, {"column_name": "Prevalence", "data_path": "action_result.data.*.prevalence", "data_type": "numeric", "column_order": 0}, {"data_path": "action_result.data.*.dateCreated", "data_type": "string"}, {"data_path": "action_result.data.*.productName", "data_type": "string"}, {"data_path": "action_result.data.*.publisherId", "data_type": "numeric"}, {"data_path": "action_result.data.*.certificateId", "data_type": "numeric"}, {"data_path": "action_result.data.*.fileExtension", "data_type": "string"}, {"data_path": "action_result.data.*.trustMessages", "data_type": "string"}, {"data_path": "action_result.data.*.effectiveState", "data_type": "string"}, {"data_path": "action_result.data.*.productVersion", "data_type": "string"}, {"data_path": "action_result.data.*.publisherState", "data_type": "numeric"}, {"data_path": "action_result.data.*.sha256HashType", "data_type": "numeric"}, {"data_path": "action_result.data.*.certificateState", "data_type": "numeric"}, {"data_path": "action_result.data.*.reputationEnabled", "data_type": "boolean"}, {"data_path": "action_result.data.*.publisherOrCompany", "data_type": "string"}, {"data_path": "action_result.data.*.reputationAvailable", "data_type": "boolean"}, {"data_path": "action_result.data.*.approvedByReputation", "data_type": "boolean"}, {"data_path": "action_result.data.*.installedProgramName", "data_type": "string"}, {"data_path": "action_result.status", "data_type": "string"}, {"data_path": "action_result.message", "data_type": "string"}, {"data_path": "action_result.summary.prevalence", "data_type": "numeric"}, {"data_path": "action_result.parameter.hash", "data_type": "string"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}]}], "name": "hunt_file_1", "custom_name": "", "connection_name": "start", "action_type": "investigate", "action": "hunt file", "position": {"y": 260, "x": 440}, "z": 2587}, {"custom_code": "def on_start(container):\n\n    # call 'hunt_domain_1' block\n    hunt_domain_1(container=container)\n    \n    # call 'hunt_file_1' block\n    hunt_file_1(container=container)\n    \n    # call 'file_reputation_1' block\n    file_reputation_1(container=container)\n\n    # call 'whois_domain_1' block\n    whois_domain_1(container=container)\n\n    # call 'run_query_1' block\n    run_query_1(container=container)\n\n    return", "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#FFFFFF"}, ".title": {"text": "START"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, "text.icon": {"color": "#FFFFFF"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}}, "id": "4fed86a4-5a8f-458d-a5b6-24e31c1da76d", "size": {"width": 96, "height": 48}, "connection_type": "", "connected_to_start": false, "parameters": [], "title": "START", "inPorts": [], "1": "T", "0": "S", "3": "R", "2": "A", "4": "T", "type": "coa.StartEnd", "status": "", "warn": false, "active": false, "angle": 0, "name": "", "connection_name": "", "position": {"y": 340, "x": 240}, "z": 2597}, {"custom_code": "", "number": 1, "outPorts": ["out-1"], "attrs": {"g.error": {"opacity": 0}, ".border": {"stroke": "#5094D4", "transform": "rotate(45 30 70)"}, ".inPorts>.port-0>.port-body": {"port": {"type": "in", "id": "in"}}, ".outPorts>.port-0": {"ref-y": 40, "port": {"type": "out", "id": "out-1"}, "ref-x": 83}, ".number": {"text": 1}, ".outPorts>.port-0>.port-body": {"port": {"type": "out", "id": "out-1"}}, ".background": {"transform": "rotate(45 30 70)"}}, "id": "9f724d77-827a-405b-ae3f-455694a9e71b", "size": {"width": 82, "height": 82}, "connection_type": "action", "connected_to_start": false, "parameters": [{"fields": {"file_reputation_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "file_reputation_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}}, "name": "file_reputation_1 inputs"}, {"fields": {"file_reputation_1:action_result.data.*.sha512": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_count": {"contains": []}, "file_reputation_1:action_result.parameter.hash": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.single_scan": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.version": {"contains": []}, "file_reputation_1:action_result.data.*.status": {"contains": []}, "file_reputation_1:action_result.data.*.first_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.timestamp": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.first_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.ripemd160": {"contains": []}, "file_reputation_1:action_result.summary.positives": {"contains": []}, "file_reputation_1:action_result.data.*.sha384": {"contains": []}, "file_reputation_1:action_result.data.*.sample_type": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.name": {"contains": []}, "file_reputation_1:action_result.summary.total_scans": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.results.*.result": {"contains": []}, "file_reputation_1:action_result.data.*.sha1": {"contains": ["sha1"]}, "file_reputation_1:action_result.data.*.sha256": {"contains": ["sha256"]}, "file_reputation_1:summary.total_positives": {"contains": []}, "file_reputation_1:action_result.data.*.last_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_match": {"contains": []}, "file_reputation_1:action_result.data.*.sample_size": {"contains": []}, "file_reputation_1:action_result.data.*.last_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.md5": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.xref.*.results.*.scanner": {"contains": []}}, "name": "file_reputation_1 results"}, {"fields": {"hunt_file_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}}, "name": "hunt_file_1 inputs"}, {"fields": {"hunt_file_1:action_result.data.*.publisherState": {"contains": []}, "hunt_file_1:action_result.data.*.reputationAvailable": {"contains": []}, "hunt_file_1:action_result.data.*.fileState": {"contains": []}, "hunt_file_1:action_result.data.*.company": {"contains": []}, "hunt_file_1:action_result.data.*.sha256HashType": {"contains": []}, "hunt_file_1:action_result.data.*.reputationEnabled": {"contains": []}, "hunt_file_1:action_result.data.*.publisherOrCompany": {"contains": []}, "hunt_file_1:action_result.data.*.md5": {"contains": []}, "hunt_file_1:action_result.message": {"contains": []}, "hunt_file_1:action_result.data.*.category": {"contains": []}, "hunt_file_1:action_result.data.*.computerId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateState": {"contains": []}, "hunt_file_1:action_result.data.*.dateCreated": {"contains": []}, "hunt_file_1:action_result.parameter.hash": {"contains": []}, "hunt_file_1:action_result.data.*.sha256": {"contains": []}, "hunt_file_1:action_result.data.*.publisherId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateId": {"contains": []}, "hunt_file_1:action_result.data.*.prevalence": {"contains": []}, "hunt_file_1:action_result.data.*.productName": {"contains": []}, "hunt_file_1:action_result.data.*.fileFlags": {"contains": []}, "hunt_file_1:action_result.data.*.publisher": {"contains": []}, "hunt_file_1:action_result.data.*.fileName": {"contains": []}, "hunt_file_1:action_result.data.*.fileSize": {"contains": []}, "hunt_file_1:action_result.data.*.pathName": {"contains": []}, "hunt_file_1:action_result.data.*.trust": {"contains": []}, "hunt_file_1:action_result.data.*.id": {"contains": []}, "hunt_file_1:action_result.id": {"contains": []}, "hunt_file_1:action_result.data.*.sha1": {"contains": []}, "hunt_file_1:action_result.data.*.fileExtension": {"contains": []}, "hunt_file_1:action_result.data.*.installedProgramName": {"contains": []}, "hunt_file_1:action_result.data.*.approvedByReputation": {"contains": []}, "hunt_file_1:action_result.data.*.fileType": {"contains": []}, "hunt_file_1:action_result.summary.prevalence": {"contains": []}, "hunt_file_1:action_result.status": {"contains": []}, "hunt_file_1:action_result.data.*.productVersion": {"contains": []}, "hunt_file_1:action_result.data.*.effectiveState": {"contains": []}, "hunt_file_1:action_result.data.*.threat": {"contains": []}, "hunt_file_1:action_result.data.*.trustMessages": {"contains": []}}, "name": "hunt_file_1 results"}, {"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "inPorts": ["in"], "state": "decision", "hasElse": false, "type": "coa.Decision", "status": "", "outputs": [{"type": "if", "conditions": [{"comparison": ">=", "param": "file_reputation_1:action_result.summary.positives", "value": "5", "data_type": ""}, {"comparison": ">=", "param": "hunt_file_1:action_result.summary.prevalence", "value": "1", "data_type": ""}], "display": "If", "logic": "and"}], "previous_block_type": "", "warn": "", "active": false, "angle": 0, "name": "", "custom_name": "", "connection_name": "file reputation, hunt file", "position": {"y": 320, "x": 680}, "z": 2601}, {"showNumber": false, "custom_code": "def get_file_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    \n    assets = get_filtered_assets(\"get file\")\n    \n    if not assets:\n        return\n\n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_file_1' call\n    inputs_data_1 = phantom.collect2(container=container, datapath=['hunt_file_1:artifact:*.cef.fileHash', 'hunt_file_1:artifact:*.id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'get_file_1' call\n    for inputs_item_1 in inputs_data_1:\n        if inputs_item_1[0]:\n            parameters.append({\n                'hash': inputs_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': inputs_item_1[1]},\n            })\n\n    if parameters:\n        phantom.act(\"get file\", parameters=parameters, assets=assets[0]['name'], callback=detonate_file_2, name=\"get_file_1\")    \n    \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "get file"}}, "reviewer": "", "message": "", "id": "b394e8d2-7451-4d35-b39b-a7be5208b783", "size": {"width": 168, "height": 112}, "connection_type": "action", "previous_name": "get_file_1", "connected_to_start": false, "parameters": [{"fields": {"filtered-artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.request": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.msg": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.in": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.startTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "filtered-artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "filtered-artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "filtered-artifact:*.cef.start": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "filtered-artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.app": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.cn1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileType": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.suid": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "filtered-artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "filtered-artifact:*.cef.cs2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cnt": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "filtered-artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.outcome": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.spriv": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.act": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs6": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs5": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs4": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.proto": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "filtered-artifact:*.cef.out": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fsize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "filtered-artifact:*.cef.rt": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.end": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "filtered-artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.message": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.fileId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "filtered-artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.endTime": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.cat": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.duid": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "filtered-artifact:*.cef.externalId": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "filtered-artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "filtered-artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}}, "name": "decision_1 filtered artifacts"}, {"fields": {"hunt_file_1:filtered-action_result.data.*.certificateState": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.publisherId": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.trustMessages": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileExtension": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileType": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.pathName": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.publisherOrCompany": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.threat": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.id": {"contains": []}, "hunt_file_1:filtered-action_result.status": {"contains": []}, "hunt_file_1:filtered-action_result.summary.prevalence": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.certificateId": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.dateCreated": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.reputationAvailable": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.prevalence": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.company": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.approvedByReputation": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.publisherState": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileName": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.installedProgramName": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileSize": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.sha1": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileState": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.sha256": {"contains": []}, "hunt_file_1:filtered-action_result.parameter.hash": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.productVersion": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.sha256HashType": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.reputationEnabled": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.productName": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.effectiveState": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.computerId": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.md5": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.publisher": {"contains": []}, "hunt_file_1:filtered-action_result.message": {"contains": []}, "hunt_file_1:filtered-action_result.id": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.category": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.fileFlags": {"contains": []}, "hunt_file_1:filtered-action_result.data.*.trust": {"contains": []}}, "name": "hunt_file_1 filtered results"}, {"fields": {"file_reputation_1:filtered-action_result.data.*.xref.*.results.*.scanner": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.sample_size": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.sha256": {"contains": ["sha256"]}, "file_reputation_1:filtered-action_result.summary.total_scans": {"contains": []}, ":filtered-file_reputation_1:summary.total_positives": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.results.*.result": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanned_on": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.first_seen_on": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.single_scan": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanners.*.version": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanners.*.timestamp": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.last_seen_on": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.sha1": {"contains": ["sha1"]}, "file_reputation_1:filtered-action_result.data.*.sha512": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.sha384": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.md5": {"contains": ["md5"]}, "file_reputation_1:filtered-action_result.data.*.first_scanned_on": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanners.*.name": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.last_scanned_on": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.ripemd160": {"contains": []}, "file_reputation_1:filtered-action_result.summary.positives": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanner_match": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.xref.*.scanner_count": {"contains": []}, "file_reputation_1:filtered-action_result.data.*.sample_type": {"contains": []}, "file_reputation_1:filtered-action_result.parameter.hash": {"contains": ["md5"]}, "file_reputation_1:filtered-action_result.data.*.status": {"contains": []}}, "name": "file_reputation_1 filtered results"}, {"fields": {"file_reputation_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "file_reputation_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}}, "name": "file_reputation_1 inputs"}, {"fields": {"file_reputation_1:action_result.data.*.sha512": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_count": {"contains": []}, "file_reputation_1:action_result.parameter.hash": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.single_scan": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.version": {"contains": []}, "file_reputation_1:action_result.data.*.status": {"contains": []}, "file_reputation_1:action_result.data.*.first_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.timestamp": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.first_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.ripemd160": {"contains": []}, "file_reputation_1:action_result.summary.positives": {"contains": []}, "file_reputation_1:action_result.data.*.sha384": {"contains": []}, "file_reputation_1:action_result.data.*.sample_type": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.name": {"contains": []}, "file_reputation_1:action_result.summary.total_scans": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.results.*.result": {"contains": []}, "file_reputation_1:action_result.data.*.sha1": {"contains": ["sha1"]}, "file_reputation_1:action_result.data.*.sha256": {"contains": ["sha256"]}, "file_reputation_1:summary.total_positives": {"contains": []}, "file_reputation_1:action_result.data.*.last_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_match": {"contains": []}, "file_reputation_1:action_result.data.*.sample_size": {"contains": []}, "file_reputation_1:action_result.data.*.last_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.md5": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.xref.*.results.*.scanner": {"contains": []}}, "name": "file_reputation_1 results"}, {"fields": {"hunt_file_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}}, "name": "hunt_file_1 inputs"}, {"fields": {"hunt_file_1:action_result.data.*.publisherState": {"contains": []}, "hunt_file_1:action_result.data.*.reputationAvailable": {"contains": []}, "hunt_file_1:action_result.data.*.fileState": {"contains": []}, "hunt_file_1:action_result.data.*.company": {"contains": []}, "hunt_file_1:action_result.data.*.sha256HashType": {"contains": []}, "hunt_file_1:action_result.data.*.reputationEnabled": {"contains": []}, "hunt_file_1:action_result.data.*.publisherOrCompany": {"contains": []}, "hunt_file_1:action_result.data.*.md5": {"contains": []}, "hunt_file_1:action_result.message": {"contains": []}, "hunt_file_1:action_result.data.*.category": {"contains": []}, "hunt_file_1:action_result.data.*.computerId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateState": {"contains": []}, "hunt_file_1:action_result.data.*.dateCreated": {"contains": []}, "hunt_file_1:action_result.parameter.hash": {"contains": []}, "hunt_file_1:action_result.data.*.sha256": {"contains": []}, "hunt_file_1:action_result.data.*.publisherId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateId": {"contains": []}, "hunt_file_1:action_result.data.*.prevalence": {"contains": []}, "hunt_file_1:action_result.data.*.productName": {"contains": []}, "hunt_file_1:action_result.data.*.fileFlags": {"contains": []}, "hunt_file_1:action_result.data.*.publisher": {"contains": []}, "hunt_file_1:action_result.data.*.fileName": {"contains": []}, "hunt_file_1:action_result.data.*.fileSize": {"contains": []}, "hunt_file_1:action_result.data.*.pathName": {"contains": []}, "hunt_file_1:action_result.data.*.trust": {"contains": []}, "hunt_file_1:action_result.data.*.id": {"contains": []}, "hunt_file_1:action_result.id": {"contains": []}, "hunt_file_1:action_result.data.*.sha1": {"contains": []}, "hunt_file_1:action_result.data.*.fileExtension": {"contains": []}, "hunt_file_1:action_result.data.*.installedProgramName": {"contains": []}, "hunt_file_1:action_result.data.*.approvedByReputation": {"contains": []}, "hunt_file_1:action_result.data.*.fileType": {"contains": []}, "hunt_file_1:action_result.summary.prevalence": {"contains": []}, "hunt_file_1:action_result.status": {"contains": []}, "hunt_file_1:action_result.data.*.productVersion": {"contains": []}, "hunt_file_1:action_result.data.*.effectiveState": {"contains": []}, "hunt_file_1:action_result.data.*.threat": {"contains": []}, "hunt_file_1:action_result.data.*.trustMessages": {"contains": []}}, "name": "hunt_file_1 results"}, {"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"hash": "hunt_file_1:artifact:*.cef.fileHash"}, "active_keys": {}, "assets": [{"fields": {"hash": "hunt_file_1:artifact:*.cef.fileHash"}, "type": "endpoint", "name": "carbonblack", "output": [{"data_path": "action_result.data.*.name", "data_type": "string"}, {"column_name": "Vault ID", "contains": ["vault id"], "data_path": "action_result.data.*.vault_id", "data_type": "string", "column_order": 1}, {"column_name": "MD5", "contains": ["md5", "hash"], "data_path": "action_result.data.*.file_details.md5", "data_type": "string", "column_order": 0}, {"data_path": "action_result.data.*.file_details.icon", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.group", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.signed", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.os_type", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.endpoint", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.is_64bit", "data_type": "boolean"}, {"data_path": "action_result.data.*.file_details.file_desc", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.last_seen", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.timestamp", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.cb_version", "data_type": "numeric"}, {"data_path": "action_result.data.*.file_details.host_count", "data_type": "numeric"}, {"data_path": "action_result.data.*.file_details.watchlists.*.wid", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.watchlists.*.value", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.company_name", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.file_version", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.orig_mod_len", "data_type": "numeric"}, {"data_path": "action_result.data.*.file_details.product_name", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.digsig_result", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.internal_name", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.copied_mod_len", "data_type": "numeric"}, {"data_path": "action_result.data.*.file_details.legal_copyright", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.product_version", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.digsig_publisher", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.digsig_sign_time", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.observed_filename", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.original_filename", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.digsig_result_code", "data_type": "string"}, {"data_path": "action_result.data.*.file_details.is_executable_image", "data_type": "boolean"}, {"data_path": "action_result.data.*.file_details.server_added_timestamp", "data_type": "string"}, {"data_path": "action_result.status", "data_type": "string"}, {"data_path": "action_result.message", "data_type": "string"}, {"data_path": "action_result.summary.name", "data_type": "string"}, {"contains": ["vault id"], "data_path": "action_result.summary.vault_id", "data_type": "string"}, {"data_path": "action_result.summary.file_type", "data_type": "string"}, {"data_path": "action_result.parameter.hash", "data_type": "string"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}]}], "name": "get_file_1", "custom_name": "", "connection_name": "file reputation, hunt file", "action_type": "investigate", "action": "get file", "position": {"y": 320, "x": 820}, "z": 2603}, {"showNumber": false, "custom_code": "def detonate_file_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    \n    assets = get_filtered_assets(\"detonate file\")\n    if not assets:\n        return\n\n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'detonate_file_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_file_1:action_result.data.*.vault_id', 'get_file_1:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'detonate_file_2' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'file_name': \"\",\n                'vault_id': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    if parameters:\n        phantom.act(\"detonate file\", parameters=parameters, assets=assets, name=\"detonate_file_2\", parent_action=action)    \n    \n    return", "number": 2, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "detonate file"}}, "reviewer": "", "message": "", "id": "eeb14016-24e5-4d21-9f85-3e807b8af8e9", "size": {"width": 168, "height": 112}, "connection_type": "action", "previous_name": "detonate_file_2", "connected_to_start": false, "parameters": [{"fields": {"get_file_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "get_file_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "get_file_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "get_file_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "get_file_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "get_file_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "get_file_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "get_file_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "get_file_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "get_file_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "get_file_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "get_file_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "get_file_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "get_file_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "get_file_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "get_file_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "get_file_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "get_file_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "get_file_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "get_file_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "get_file_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "get_file_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "get_file_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "get_file_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "get_file_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "get_file_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "get_file_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "get_file_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "get_file_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}}, "name": "get_file_1 inputs"}, {"fields": {"get_file_1:action_result.summary.name": {"contains": []}, "get_file_1:action_result.data.*.name": {"contains": []}, "get_file_1:action_result.data.*.file_details.company_name": {"contains": []}, "get_file_1:action_result.data.*.file_details.digsig_result_code": {"contains": []}, "get_file_1:action_result.data.*.file_details.observed_filename": {"contains": []}, "get_file_1:action_result.data.*.file_details.digsig_result": {"contains": []}, "get_file_1:action_result.data.*.file_details.timestamp": {"contains": []}, "get_file_1:action_result.data.*.file_details.signed": {"contains": []}, "get_file_1:action_result.data.*.file_details.original_filename": {"contains": []}, "get_file_1:action_result.data.*.file_details.last_seen": {"contains": []}, "get_file_1:action_result.data.*.file_details.watchlists.*.wid": {"contains": []}, "get_file_1:action_result.data.*.file_details.file_desc": {"contains": []}, "get_file_1:action_result.parameter.hash": {"contains": []}, "get_file_1:action_result.data.*.file_details.endpoint": {"contains": []}, "get_file_1:action_result.data.*.file_details.internal_name": {"contains": []}, "get_file_1:action_result.data.*.file_details.digsig_publisher": {"contains": []}, "get_file_1:action_result.data.*.file_details.server_added_timestamp": {"contains": []}, "get_file_1:action_result.data.*.file_details.is_64bit": {"contains": []}, "get_file_1:action_result.data.*.vault_id": {"contains": ["vault id"]}, "get_file_1:action_result.data.*.file_details.host_count": {"contains": []}, "get_file_1:action_result.data.*.file_details.digsig_sign_time": {"contains": []}, "get_file_1:action_result.data.*.file_details.orig_mod_len": {"contains": []}, "get_file_1:action_result.data.*.file_details.is_executable_image": {"contains": []}, "get_file_1:action_result.status": {"contains": []}, "get_file_1:action_result.data.*.file_details.group": {"contains": []}, "get_file_1:action_result.data.*.file_details.legal_copyright": {"contains": []}, "get_file_1:action_result.data.*.file_details.product_version": {"contains": []}, "get_file_1:action_result.data.*.file_details.md5": {"contains": ["md5", "hash"]}, "get_file_1:action_result.data.*.file_details.os_type": {"contains": []}, "get_file_1:action_result.data.*.file_details.file_version": {"contains": []}, "get_file_1:action_result.message": {"contains": []}, "get_file_1:action_result.data.*.file_details.cb_version": {"contains": []}, "get_file_1:action_result.summary.vault_id": {"contains": ["vault id"]}, "get_file_1:action_result.data.*.file_details.watchlists.*.value": {"contains": []}, "get_file_1:action_result.data.*.file_details.copied_mod_len": {"contains": []}, "get_file_1:action_result.data.*.file_details.icon": {"contains": []}, "get_file_1:action_result.data.*.file_details.product_name": {"contains": []}, "get_file_1:action_result.summary.file_type": {"contains": []}}, "name": "get_file_1 results"}, {"fields": {"file_reputation_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "file_reputation_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "file_reputation_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "file_reputation_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "file_reputation_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "file_reputation_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "file_reputation_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "file_reputation_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "file_reputation_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "file_reputation_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}}, "name": "file_reputation_1 inputs"}, {"fields": {"file_reputation_1:action_result.data.*.sha512": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_count": {"contains": []}, "file_reputation_1:action_result.parameter.hash": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.single_scan": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.version": {"contains": []}, "file_reputation_1:action_result.data.*.status": {"contains": []}, "file_reputation_1:action_result.data.*.first_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.timestamp": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.first_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.ripemd160": {"contains": []}, "file_reputation_1:action_result.summary.positives": {"contains": []}, "file_reputation_1:action_result.data.*.sha384": {"contains": []}, "file_reputation_1:action_result.data.*.sample_type": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanners.*.name": {"contains": []}, "file_reputation_1:action_result.summary.total_scans": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.results.*.result": {"contains": []}, "file_reputation_1:action_result.data.*.sha1": {"contains": ["sha1"]}, "file_reputation_1:action_result.data.*.sha256": {"contains": ["sha256"]}, "file_reputation_1:summary.total_positives": {"contains": []}, "file_reputation_1:action_result.data.*.last_seen_on": {"contains": []}, "file_reputation_1:action_result.data.*.xref.*.scanner_match": {"contains": []}, "file_reputation_1:action_result.data.*.sample_size": {"contains": []}, "file_reputation_1:action_result.data.*.last_scanned_on": {"contains": []}, "file_reputation_1:action_result.data.*.md5": {"contains": ["md5"]}, "file_reputation_1:action_result.data.*.xref.*.results.*.scanner": {"contains": []}}, "name": "file_reputation_1 results"}, {"fields": {"hunt_file_1:artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.fileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.externalId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.in": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.endTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.outcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.start": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.end": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.startTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.proto": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.duid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.out": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.spriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "hunt_file_1:artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "hunt_file_1:artifact:*.cef.message": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.app": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.act": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "hunt_file_1:artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "hunt_file_1:artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "hunt_file_1:artifact:*.cef.msg": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs6": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs5": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs2": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs3": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cs1": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "hunt_file_1:artifact:*.cef.suid": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cnt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.request": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "hunt_file_1:artifact:*.cef.cat": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.fsize": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "hunt_file_1:artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "hunt_file_1:artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "hunt_file_1:artifact:*.cef.rt": {"contains": [], "type": "string"}, "hunt_file_1:artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}}, "name": "hunt_file_1 inputs"}, {"fields": {"hunt_file_1:action_result.data.*.publisherState": {"contains": []}, "hunt_file_1:action_result.data.*.reputationAvailable": {"contains": []}, "hunt_file_1:action_result.data.*.fileState": {"contains": []}, "hunt_file_1:action_result.data.*.company": {"contains": []}, "hunt_file_1:action_result.data.*.sha256HashType": {"contains": []}, "hunt_file_1:action_result.data.*.reputationEnabled": {"contains": []}, "hunt_file_1:action_result.data.*.publisherOrCompany": {"contains": []}, "hunt_file_1:action_result.data.*.md5": {"contains": []}, "hunt_file_1:action_result.message": {"contains": []}, "hunt_file_1:action_result.data.*.category": {"contains": []}, "hunt_file_1:action_result.data.*.computerId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateState": {"contains": []}, "hunt_file_1:action_result.data.*.dateCreated": {"contains": []}, "hunt_file_1:action_result.parameter.hash": {"contains": []}, "hunt_file_1:action_result.data.*.sha256": {"contains": []}, "hunt_file_1:action_result.data.*.publisherId": {"contains": []}, "hunt_file_1:action_result.data.*.certificateId": {"contains": []}, "hunt_file_1:action_result.data.*.prevalence": {"contains": []}, "hunt_file_1:action_result.data.*.productName": {"contains": []}, "hunt_file_1:action_result.data.*.fileFlags": {"contains": []}, "hunt_file_1:action_result.data.*.publisher": {"contains": []}, "hunt_file_1:action_result.data.*.fileName": {"contains": []}, "hunt_file_1:action_result.data.*.fileSize": {"contains": []}, "hunt_file_1:action_result.data.*.pathName": {"contains": []}, "hunt_file_1:action_result.data.*.trust": {"contains": []}, "hunt_file_1:action_result.data.*.id": {"contains": []}, "hunt_file_1:action_result.id": {"contains": []}, "hunt_file_1:action_result.data.*.sha1": {"contains": []}, "hunt_file_1:action_result.data.*.fileExtension": {"contains": []}, "hunt_file_1:action_result.data.*.installedProgramName": {"contains": []}, "hunt_file_1:action_result.data.*.approvedByReputation": {"contains": []}, "hunt_file_1:action_result.data.*.fileType": {"contains": []}, "hunt_file_1:action_result.summary.prevalence": {"contains": []}, "hunt_file_1:action_result.status": {"contains": []}, "hunt_file_1:action_result.data.*.productVersion": {"contains": []}, "hunt_file_1:action_result.data.*.effectiveState": {"contains": []}, "hunt_file_1:action_result.data.*.threat": {"contains": []}, "hunt_file_1:action_result.data.*.trustMessages": {"contains": []}}, "name": "hunt_file_1 results"}, {"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"file_name": "", "vault_id": "get_file_1:action_result.data.*.vault_id"}, "active_keys": {}, "assets": [{"fields": {"file_name": "", "vault_id": "get_file_1:action_result.data.*.vault_id"}, "type": "sandbox", "name": "wildfire", "output": [{"data_path": "action_result.data.*.version", "data_type": "string"}, {"contains": ["md5", "hash"], "data_path": "action_result.data.*.file_info.md5", "data_type": "string"}, {"contains": ["sha1", "hash"], "data_path": "action_result.data.*.file_info.sha1", "data_type": "string"}, {"data_path": "action_result.data.*.file_info.size", "data_type": "string"}, {"contains": ["sha256", "hash"], "data_path": "action_result.data.*.file_info.sha256", "data_type": "string"}, {"data_path": "action_result.data.*.file_info.malware", "data_type": "string"}, {"data_path": "action_result.data.*.file_info.filetype", "data_type": "string"}, {"contains": ["md5", "hash"], "data_path": "action_result.data.*.task_info.report.*.md5", "data_type": "string"}, {"contains": ["sha256", "hash"], "data_path": "action_result.data.*.task_info.report.*.sha256", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.malware", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.summary.entry.*.@id", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.summary.entry.*.#text", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.summary.entry.*.@score", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.summary.entry.*.@details", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.version", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.platform", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.software", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.size", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.dns.*.@type", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.dns.*.@query", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.dns.*.@response", "data_type": "string"}, {"contains": ["ip"], "data_path": "action_result.data.*.task_info.report.*.network.tcp.*.@ip", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.tcp.*.@port", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.tcp.*.@country", "data_type": "string"}, {"contains": ["md5", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.@md5", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.#text", "data_type": "string"}, {"contains": ["sha1", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.@sha1", "data_type": "string"}, {"contains": ["sha256", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.@sha256", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.@behavior_id", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.timeline.entry.*.@seq", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.timeline.entry.*.#text", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.@pid", "data_type": "string"}, {"contains": ["md5", "hash"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@md5", "data_type": "string"}, {"contains": ["file path"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@name", "data_type": "string"}, {"contains": ["sha1", "hash"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@sha1", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@size", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@type", "data_type": "string"}, {"contains": ["sha256", "hash"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.file.create.*.@sha256", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.process_list.process.*.@name", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.mutex.createmutex.*.@name", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.@command", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.registry.set.*.@key", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.registry.set.*.@data", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.registry.set.*.@subkey", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.registry.create.*.@key", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_list.process.*.registry.create.*.@subkey", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.process_tree.*.process.@pid", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.process_tree.*.process.@name", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.process_tree.*.process.@text", "data_type": "string"}, {"contains": ["md5", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.*.@md5", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.*.#text", "data_type": "string"}, {"contains": ["sha1", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.*.@sha1", "data_type": "string"}, {"contains": ["sha256", "hash"], "data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.*.@sha256", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.evidence.file.entry.*.@behavior_id", "data_type": "string"}, {"data_path": "action_result.status", "data_type": "string"}, {"data_path": "action_result.message", "data_type": "string"}, {"data_path": "action_result.summary.malware", "data_type": "string"}, {"contains": ["vault id"], "data_path": "action_result.parameter.vault_id", "data_type": "string"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.file.file_deleted.*.@pid", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.file.file_deleted.*.@deleted_file", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.file.file_deleted.*.@process_image", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.file.file_written.*.@pid", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.file.file_written.*.@written_file", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.file.file_written.*.@process_image", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.task", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.udp.*.@ip", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.udp.*.@port", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.udp.*.@country", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.url.*.@uri", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.url.*.@host", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.url.*.@method", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.network.url.*.@user_agent", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.registry.deletekey.*.@pid", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.registry.deletekey.*.@reg_key", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.registry.deletekey.*.@process_image", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.registry.setvaluekey.*.@pid", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.registry.setvaluekey.*.@reg_key", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.registry.setvaluekey.*.@process_image", "data_type": "string"}, {"contains": ["pid"], "data_path": "action_result.data.*.task_info.report.*.registry.deletevaluekey.*.@pid", "data_type": "string"}, {"data_path": "action_result.data.*.task_info.report.*.registry.deletevaluekey.*.@reg_key", "data_type": "string"}, {"contains": ["process name"], "data_path": "action_result.data.*.task_info.report.*.registry.deletevaluekey.*.@process_image", "data_type": "string"}, {"data_path": "action_result.parameter.file_name", "data_type": "string"}]}], "name": "detonate_file_2", "custom_name": "", "connection_name": "get file", "action_type": "investigate", "action": "detonate file", "position": {"y": 320, "x": 1060}, "z": 2607}, {"showNumber": false, "custom_code": "def file_reputation_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"file reputation\", excluded_products=[\"VirusTotal\", \"TitaniumCloud\"])\n    \n    if not assets:\n        return\n    \n    # collect data for 'file_reputation_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.fileHash', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'file_reputation_1' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'hash': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    if parameters:\n        phantom.act(\"file reputation\", parameters=parameters, callback=join_decision_1, name=\"file_reputation_1\", assets=assets)    \n    \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "file reputation"}}, "reviewer": "", "message": "", "id": "4ba1f991-42c7-440e-bf58-a3d5d9726dc9", "size": {"width": 168, "height": 112}, "connection_type": "object", "previous_name": "file_reputation_1", "connected_to_start": true, "parameters": [{"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"hash": "artifact:*.cef.fileHash"}, "active_keys": {}, "assets": [{"fields": {"hash": "artifact:*.cef.fileHash"}, "type": "reputation", "name": "reversinglabs_private", "output": [{"contains": ["md5"], "data_path": "action_result.parameter.hash", "data_type": "string"}, {"data_path": "action_result.data.*.status", "data_type": "string"}, {"contains": ["sha1"], "data_path": "action_result.data.*.sha1", "data_type": "string"}, {"data_path": "action_result.data.*.first_seen_on", "data_type": "string"}, {"data_path": "action_result.data.*.last_scanned_on", "data_type": "string"}, {"data_path": "action_result.data.*.last_seen_on", "data_type": "string"}, {"data_path": "action_result.data.*.single_scan", "data_type": "boolean"}, {"data_path": "action_result.data.*.first_scanned_on", "data_type": "string"}, {"data_path": "action_result.data.*.sample_type", "data_type": "string"}, {"data_path": "action_result.data.*.sample_size", "data_type": "numeric"}, {"data_path": "action_result.data.*.xref.*.scanner_match", "data_type": "numeric"}, {"data_path": "action_result.data.*.xref.*.scanner_count", "data_type": "numeric"}, {"data_path": "action_result.data.*.xref.*.results.*.result", "data_type": "string"}, {"data_path": "action_result.data.*.xref.*.results.*.scanner", "data_type": "string"}, {"data_path": "action_result.data.*.xref.*.scanned_on", "data_type": "string"}, {"data_path": "action_result.data.*.xref.*.scanners.*.timestamp", "data_type": "string"}, {"data_path": "action_result.data.*.xref.*.scanners.*.version", "data_type": "string"}, {"data_path": "action_result.data.*.xref.*.scanners.*.name", "data_type": "string"}, {"data_path": "action_result.data.*.sha384", "data_type": "string"}, {"contains": ["sha256"], "data_path": "action_result.data.*.sha256", "data_type": "string"}, {"data_path": "action_result.data.*.sha512", "data_type": "string"}, {"data_path": "action_result.data.*.ripemd160", "data_type": "string"}, {"contains": ["md5"], "data_path": "action_result.data.*.md5", "data_type": "string"}, {"data_path": "action_result.summary.positives", "data_type": "numeric"}, {"data_path": "action_result.summary.total_scans", "data_type": "numeric"}, {"data_path": "summary.total_positives", "data_type": "numeric"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}]}], "name": "file_reputation_1", "custom_name": "", "connection_name": "start", "action_type": "investigate", "action": "file reputation", "position": {"y": 380, "x": 440}, "z": 2609}, {"showNumber": false, "custom_code": "def run_query_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"run query\", excluded_products=[\"Exchange\", \"Windows Server\", \"Zendesk\"])\n    return\n\n    if not assets:\n        return\n    \n    container_data_src = phantom.collect2(container=container, datapath=['artifact:*.cef.sourceAddress', 'artifact:*.id'])\n    container_data_dst = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationAddress', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'run_query_1' call\n    \n    assets = phantom.get_assets(\"run query\")\n    \n    if parameters and assets:\n        for asset in assets:\n            if asset['product_name'] == \"Splunk Enterprise\":\n                for container_item in container_data_src:\n                    if container_item[0]:\n                        parameters.append({\n                            'query': container_item[0],\n                            'display': \"\",\n                            # context (artifact id) is added to associate results with the artifact\n                            'context': {'artifact_id': container_item[1]},\n                        })\n            \n                for container_item in container_data_dst:\n                    if container_item[0]:\n                        parameters.append({\n                            'query': container_item[0],\n                            'display': \"\",\n                            # context (artifact id) is added to associate results with the artifact\n                            'context': {'artifact_id': container_item[1]},\n                        })\n    \n                phantom.act(\"run query\", parameters=parameters, assets=[asset], name=\"run_query_1\")\n                continue\n            elif asset['product_name'] == \"Tanium\":\n                # define a TANIUM query here\n                #phantom.act(\"run query\", parameters=parameters, assets=[target_asset['name']], name=\"run_query_1\")\n                continue\n            elif asset['product_name'] == \"Carbon Black\":\n                # define a CarbonBlack query here\n                #phantom.act(\"run query\", parameters=parameters, assets=[target_asset['name']], name=\"run_query_1\")\n                continue\n    \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "run query"}}, "reviewer": "", "message": "", "id": "21473efc-e092-47f7-b7b9-7da11c863b83", "size": {"width": 168, "height": 112}, "connection_type": "object", "previous_name": "run_query_1", "connected_to_start": true, "parameters": [{"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"query": "artifact:*.cef.destinationAddress", "display": ""}, "active_keys": {}, "assets": [{"fields": {"query": "artifact:*.cef.destinationAddress", "display": ""}, "type": "siem", "name": "splunk_entr", "output": [{"column_name": "Host", "contains": [], "data_path": "action_result.data.*.host", "data_type": "string", "column_order": "0"}, {"column_name": "Time", "contains": [], "data_path": "action_result.data.*._time", "data_type": "string", "column_order": "1"}, {"column_name": "Raw", "contains": [], "data_path": "action_result.data.*._raw", "data_type": "string", "column_order": "2"}]}], "name": "run_query_1", "custom_name": "", "connection_name": "start", "action_type": "investigate", "action": "run query", "position": {"y": 500, "x": 440}, "z": 2611}, {"showNumber": false, "custom_code": "def hunt_domain_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"hunt domain\", excluded_products=[\"AutoFocus\",\"ThreatScape\"])\n    \n    if not assets:\n        return\n    \n    # collect data for 'hunt_domain_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationDnsDomain', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'hunt_domain_1' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'domain': container_item[0],\n                'count_only': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    if parameters:\n        phantom.act(\"hunt domain\", parameters=parameters, assets=assets, callback=decision_2, name=\"hunt_domain_1\")    \n        \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "hunt domain"}}, "reviewer": "", "message": "", "id": "0f084c8f-0d50-4a5a-8b1a-e0a0f56acb7c", "size": {"width": 168, "height": 112}, "connection_type": "object", "previous_name": "hunt_domain_1", "connected_to_start": true, "parameters": [{"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"domain": "artifact:*.cef.destinationDnsDomain", "count_only": ""}, "active_keys": {}, "assets": [{"fields": {"domain": "artifact:*.cef.destinationDnsDomain", "count_only": ""}, "type": "endpoint", "name": "falconhostapi", "output": [{"column_name": "Falcon Device ID", "contains": ["falcon device id"], "data_path": "action_result.data.*.device_id", "data_type": "string", "column_order": 0}, {"data_path": "action_result.status", "data_type": "string"}, {"contains": ["domain"], "data_path": "action_result.parameter.domain", "data_type": "string"}, {"data_path": "action_result.parameter.count_only", "data_type": "boolean"}, {"data_path": "action_result.summary.device_count", "data_type": "numeric"}]}], "name": "hunt_domain_1", "custom_name": "", "connection_name": "start", "action_type": "investigate", "action": "hunt domain", "position": {"y": 20, "x": 440}, "z": 2612}, {"showNumber": false, "custom_code": "def whois_domain_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n\n    assets = get_filtered_assets(\"whois domain\", excluded_products=[\"Whois\"])\n    if not assets:\n        return\n    \n    # collect data for 'whois_domain_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationDnsDomain', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'whois_domain_1' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'domain': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    #assets = []          \n            \n    #assets = phantom.get_assets(\"whois domain\")\n    \n    if parameters:\n        phantom.act(\"whois domain\", parameters=parameters, name=\"whois_domain_1\", assets=assets)    \n    \n    return", "number": 1, "outPorts": ["out"], "attrs": {"g.error": {"opacity": 0}, "rect.warn-background": {"fill": "#5094D4"}, ".title": {"text": "Investigate"}, ".inPorts>.port-in": {"ref": ".background", "ref-x": 0.5}, ".border": {"stroke": "#5094D4"}, ".outPorts>.port-out": {"ref": ".background", "ref-x": 0.5}, ".status": {"ref-y": 68, "fill": "#FFFFFF"}, ".message": {"text": "", "ref-y": 70, "ref-x": 16}, ".outPorts>.port-out>.port-body": {"port": {"type": "out", "id": "out"}}, ".background": {"height": 88}, ".inPorts>.port-in>.port-body": {"port": {"type": "in", "id": "in"}}, "text.icon": {"fill": "#5094D4"}, "g.code image": {"xlink:href": "/inc/coa/img/icon_code_on.svg"}, ".color-band": {"fill": "#654796"}, ".action": {"text": "whois domain"}}, "reviewer": "", "message": "", "id": "c27d207a-ca0b-4447-bb2f-e521d574d01a", "size": {"width": 168, "height": 112}, "connection_type": "object", "previous_name": "whois_domain_1", "connected_to_start": true, "parameters": [{"fields": {"artifact:*.cef.deviceCustomDate2Label": {"contains": [], "type": "string"}, "artifact:*.cef.dst": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.sourceNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.dvc": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.cs3Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileType": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4Label": {"contains": [], "type": "string"}, "artifact:*.cef.fileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.sntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.applicationProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.spriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceHostname": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.requestCookies": {"contains": [], "type": "string"}, "artifact:*.cef.destinationPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.endTime": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDirection": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate2": {"contains": [], "type": "string"}, "artifact:*.cef.rt": {"contains": [], "type": "string"}, "artifact:*.cef.proto": {"contains": [], "type": "string"}, "artifact:*.cef.cs4Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationServiceName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.deviceExternalId": {"contains": [], "type": "string"}, "artifact:*.cef.in": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString5Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationNtDomain": {"contains": [], "type": "string"}, "artifact:*.cef.requestClientApplication": {"contains": [], "type": "string"}, "artifact:*.cef.receiptTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs2Label": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.fileType": {"contains": [], "type": "string"}, "artifact:*.cef.fsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.deviceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.cn2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.cs6Label": {"contains": [], "type": "string"}, "artifact:*.cef.suid": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileId": {"contains": [], "type": "string"}, "artifact:*.cef.cn3": {"contains": [], "type": "string"}, "artifact:*.cef.cn2": {"contains": [], "type": "string"}, "artifact:*.cef.cn1": {"contains": [], "type": "string"}, "artifact:*.cef.transportProtocol": {"contains": [], "type": "string"}, "artifact:*.cef.cat": {"contains": [], "type": "string"}, "artifact:*.cef.baseEventCount": {"contains": [], "type": "string"}, "artifact:*.cef.cnt": {"contains": [], "type": "string"}, "artifact:*.cef.destinationUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceInboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.sourceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.oldfsize": {"contains": [], "type": "string"}, "artifact:*.cef.destinationAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dntdom": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.deviceEventCategory": {"contains": [], "type": "string"}, "artifact:*.cef.msg": {"contains": [], "type": "string"}, "artifact:*.cef.filePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.deviceFacility": {"contains": [], "type": "string"}, "artifact:*.cef.cs1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomDate1Label": {"contains": [], "type": "string"}, "artifact:*.cef.bytesOut": {"contains": [], "type": "string"}, "artifact:*.cef.sourceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString1Label": {"contains": [], "type": "string"}, "artifact:*.cef.sourceHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.outcome": {"contains": [], "type": "string"}, "artifact:*.cef.dhost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.eventOutcome": {"contains": [], "type": "string"}, "artifact:*.cef.fileName": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.end": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.deviceCustomNumber2Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.spt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.sourceUserName": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.deviceCustomNumber1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString6": {"contains": [], "type": "string"}, "artifact:*.cef.deviceAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString5": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3": {"contains": [], "type": "string"}, "artifact:*.cef.bytesIn": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString1": {"contains": [], "type": "string"}, "artifact:*.cef.duid": {"contains": [], "type": "string"}, "artifact:*.cef.dpriv": {"contains": [], "type": "string"}, "artifact:*.cef.deviceOutboundInterface": {"contains": [], "type": "string"}, "artifact:*.cef.fname": {"contains": ["file name"], "type": "string"}, "artifact:*.cef.duser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.startTime": {"contains": [], "type": "string"}, "artifact:*.cef.cs4": {"contains": [], "type": "string"}, "artifact:*.cef.cs5": {"contains": [], "type": "string"}, "artifact:*.cef.cs6": {"contains": [], "type": "string"}, "artifact:*.cef.sourcePort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.cs1": {"contains": [], "type": "string"}, "artifact:*.cef.cs2": {"contains": [], "type": "string"}, "artifact:*.cef.cs3": {"contains": [], "type": "string"}, "artifact:*.cef.fileId": {"contains": [], "type": "string"}, "artifact:*.cef.oldfilePermission": {"contains": [], "type": "string"}, "artifact:*.cef.destinationProcessName": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.act": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileModificationTime": {"contains": [], "type": "string"}, "artifact:*.cef.out": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceAction": {"contains": [], "type": "string"}, "artifact:*.cef.fileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.requestURL": {"contains": ["url"], "type": "string"}, "artifact:*.cef.start": {"contains": [], "type": "string"}, "artifact:*.cef.src": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.dpt": {"contains": ["port"], "type": "string"}, "artifact:*.cef.dmac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceServiceName": {"contains": [], "type": "string"}, "artifact:*.cef.sourceMacAddress": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.sourceUserId": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString4": {"contains": [], "type": "string"}, "artifact:*.cef.oldfileHash": {"contains": ["hash"], "type": "string"}, "artifact:*.cef.suser": {"contains": ["user name"], "type": "string"}, "artifact:*.cef.app": {"contains": [], "type": "string"}, "artifact:*.cef.dproc": {"contains": ["process name"], "type": "string"}, "artifact:*.cef.destinationHostName": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.sourceDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.sourceTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.destinationDnsDomain": {"contains": ["domain"], "type": "string"}, "artifact:*.cef.fileSize": {"contains": [], "type": "string"}, "artifact:*.cef.deviceTranslatedAddress": {"contains": ["ip"], "type": "string"}, "artifact:*.cef.deviceCustomString6Label": {"contains": [], "type": "string"}, "artifact:*.cef.dvchost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.cn3Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomString3Label": {"contains": [], "type": "string"}, "artifact:*.cef.cs5Label": {"contains": [], "type": "string"}, "artifact:*.cef.shost": {"contains": ["host name"], "type": "string"}, "artifact:*.cef.deviceCustomString2Label": {"contains": [], "type": "string"}, "artifact:*.cef.request": {"contains": [], "type": "string"}, "artifact:*.cef.requestMethod": {"contains": [], "type": "string"}, "artifact:*.cef.sourceUserPrivileges": {"contains": [], "type": "string"}, "artifact:*.cef.externalId": {"contains": [], "type": "string"}, "artifact:*.cef.cn1Label": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber2": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber1": {"contains": [], "type": "string"}, "artifact:*.cef.deviceCustomNumber3Label": {"contains": [], "type": "string"}, "artifact:*.cef.destinationTranslatedPort": {"contains": ["port"], "type": "string"}, "artifact:*.cef.filePath": {"contains": ["file path"], "type": "string"}, "artifact:*.cef.oldfileCreateTime": {"contains": [], "type": "string"}, "artifact:*.cef.smac": {"contains": ["mac address"], "type": "string"}, "artifact:*.cef.destinationUserId": {"contains": [], "type": "string"}, "artifact:*.cef.message": {"contains": [], "type": "string"}}, "name": "artifact:*.cef"}], "title": "Investigate", "inPorts": ["in"], "delay": "0", "color": "#654796", "state": "asset", "type": "coa.Action", "status": "", "approver": "", "previous_block_type": "", "warn": false, "active": false, "angle": 0, "active_values": {"domain": "artifact:*.cef.destinationDnsDomain"}, "active_keys": {}, "assets": [{"fields": {"domain": "artifact:*.cef.destinationDnsDomain"}, "type": "information", "name": "domaintools", "output": [{"data_path": "action_result.data.*.whois.date", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.whois.record", "data_type": "string"}, {"data_path": "action_result.data.*.registrant", "data_type": "string"}, {"data_path": "action_result.data.*.name_servers", "data_type": "string"}, {"contains": ["domain"], "data_path": "action_result.data.*.parsed_whois.domain", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.fax", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.org", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.city", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.name", "data_type": "string"}, {"contains": ["email"], "data_path": "action_result.data.*.parsed_whois.contacts.tech.email", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.phone", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.state", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.postal", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.street", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.tech.country", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.admin.fax", "data_type": "string"}, {"column_name": "Admin Organization", "data_path": "action_result.data.*.parsed_whois.contacts.admin.org", "data_type": "string", "column_order": 7}, {"column_name": "Admin City", "data_path": "action_result.data.*.parsed_whois.contacts.admin.city", "data_type": "string", "column_order": 3}, {"column_name": "Admin Name", "data_path": "action_result.data.*.parsed_whois.contacts.admin.name", "data_type": "string", "column_order": 6}, {"column_name": "Admin Email", "contains": ["email"], "data_path": "action_result.data.*.parsed_whois.contacts.admin.email", "data_type": "string", "column_order": 5}, {"data_path": "action_result.data.*.parsed_whois.contacts.admin.phone", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.admin.state", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.admin.postal", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.admin.street", "data_type": "string"}, {"column_name": "Admin Country", "data_path": "action_result.data.*.parsed_whois.contacts.admin.country", "data_type": "string", "column_order": 4}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.fax", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.org", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.city", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.name", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.email", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.phone", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.state", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.postal", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.billing.country", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.registrant.fax", "data_type": "string"}, {"column_name": "Registrant Organization", "data_path": "action_result.data.*.parsed_whois.contacts.registrant.org", "data_type": "string", "column_order": 12}, {"column_name": "Registrant City", "data_path": "action_result.data.*.parsed_whois.contacts.registrant.city", "data_type": "string", "column_order": 8}, {"column_name": "Registrant Name", "data_path": "action_result.data.*.parsed_whois.contacts.registrant.name", "data_type": "string", "column_order": 11}, {"column_name": "Registrant Email", "contains": ["email"], "data_path": "action_result.data.*.parsed_whois.contacts.registrant.email", "data_type": "string", "column_order": 10}, {"column_name": "Registrant Phone", "data_path": "action_result.data.*.parsed_whois.contacts.registrant.phone", "data_type": "string", "column_order": 13}, {"data_path": "action_result.data.*.parsed_whois.contacts.registrant.state", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.registrant.postal", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.contacts.registrant.street", "data_type": "string"}, {"column_name": "Registrant Country", "data_path": "action_result.data.*.parsed_whois.contacts.registrant.country", "data_type": "string", "column_order": 9}, {"data_path": "action_result.data.*.parsed_whois.statuses", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.registrar.url", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.registrar.name", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.registrar.iana_id", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.registrar.whois_server", "data_type": "string"}, {"contains": ["email"], "data_path": "action_result.data.*.parsed_whois.registrar.abuse_contact_email", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.registrar.abuse_contact_phone", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.created_date", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.expired_date", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.name_servers", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.updated_date", "data_type": "string"}, {"data_path": "action_result.data.*.parsed_whois.other_properties.dnssec", "data_type": "string"}, {"contains": ["domain"], "data_path": "action_result.data.*.parsed_whois.other_properties.registry_domain_id", "data_type": "string"}, {"data_path": "action_result.data.*.registration.created", "data_type": "string"}, {"data_path": "action_result.data.*.registration.expires", "data_type": "string"}, {"data_path": "action_result.data.*.registration.updated", "data_type": "string"}, {"data_path": "action_result.data.*.registration.statuses", "data_type": "string"}, {"data_path": "action_result.data.*.registration.registrar", "data_type": "string"}, {"data_path": "action_result.data.*.record_source", "data_type": "string"}, {"column_name": "Status", "data_path": "action_result.status", "data_type": "string", "column_order": 2}, {"data_path": "action_result.message", "data_type": "string"}, {"contains": ["domain"], "data_path": "action_result.parameter.domain", "data_type": "string"}, {"data_path": "summary.total_objects", "data_type": "numeric"}, {"data_path": "summary.total_objects_successful", "data_type": "numeric"}]}], "name": "whois_domain_1", "custom_name": "", "connection_name": "start", "action_type": "investigate", "action": "whois domain", "position": {"y": 140, "x": 440}, "z": 2613}]}, "code_block": "import traceback\n\ndef get_filtered_assets(action, excluded_products=None):\n    \n    supported_assets = phantom.get_assets(action=action)\n    phantom.debug(supported_assets)\n    ret_assets=[]\n    \n    if not supported_assets:\n        return []\n    \n    if excluded_products:\n        excluded_products = [x.lower() for x in excluded_products]\n    \n    for asset in supported_assets:\n        if excluded_products:\n            if asset['product_name'].lower() not in excluded_products:\n                ret_assets.append(asset['name'])\n        else:\n            ret_assets.append(asset['name'])\n    \n    phantom.debug(ret_assets)\n    return ret_assets\n\ndef asset_configured(action):\n    assets = phantom.get_assets(action=action)\n    if assets:\n        return True\n    \n    return False\n\ndef escalate(container):\n    phantom.set_severity(container, \"high\")\n    \ndef deescalate(container):\n    phantom.set_severity(container, \"low\")\n    phantom.close(container)\n\n    \ndef is_bad_domain(results):\n    \n    ODNS_KP = 'NORTH KOREA'\n    DT_KP = 'kp'\n    ATS_KP = 'North Korea'\n    WHOIS_KP = 'KP'\n    \n    ret_data=[]\n    \n    try:\n        #phantom.debug(\"domain investigation results: {}\".format(results))\n\n        collected = phantom.collect2(action_results=results, \n                                     datapath=[\"action\",                                                #0\n                                               \"app\",                                                   #1\n                                               \"status\",                                                #2\n                                               \"action_result.summary.country\",                         #3\n                                               \"action_result.data.*.registrantCountry\",                #4\n                                               \"action_result.data.*.contacts.registrant.country\",      #5\n                                               \"action_result.summary.country_code\"])                   #6\n        \n        phantom.debug(collected)     \n        \n        for item in collected:\n            \n            ret_item = {}        \n\n            if item[0] == \"whois domain\" and item[1] == \"DomainTools\" and item[2] == \"success\":\n                if item[3]:\n                    ret_item['bad']= item[3] == DT_KP\n                    ret_data.append(ret_item) \n                    continue\n\n            if item[0] == \"whois domain\" and item[1] == \"OpenDNS Investigate\" and item[2] == \"success\":\n                if item[4]:\n                    for country in item[4]:\n                        if ret_item['bad']:  # checking if the value has been set yet\n                            if ret_item['bad'] == False:  # Checking if the 'bad' bit has been already met.\n                                ret_item['bad']= item[4] == ODNS_KP\n                                ret_data.append(ret_item)\n                                continue\n                        else:\n                            ret_item['bad']= item[4] == ODNS_KP\n                            ret_data.append(ret_item)\n                            continue\n\n            if item[0] == \"whois domain\" and item[1] == \"ThreatStream\" and item[2] == \"success\":\n                if item[5]:\n                    for country in item[5]:\n                        if ret_item['bad']:  # checking if the value has been set yet\n                            if ret_item['bad'] == False:  # Checking if the 'bad' bit has been already met.\n                                ret_item['bad']= item[5] == ATS_KP\n                                ret_data.append(ret_item)\n                                continue\n                        else:\n                            ret_item['bad']= item[5] == ATS_KP\n                            ret_data.append(ret_item) \n                            continue\n\n            if item[0] == \"whois domain\" and item[1] == \"Whois\" and item[2] == \"success\":\n                if item[6]:\n                    ret_item['bad']= item[6] == WHOIS_KP\n                    ret_data.append(ret_item)\n                    continue\n        \n        \n    except:\n        phantom.error(\"Exception ocurred in parsing results: {}\".format(traceback.format_exc()))\n        \n    return ret_data        \n\ndef is_present(results):\n    \n    ret_data=[]\n    \n    try:\n        #phantom.debug(\"ip investigation results: {}\".format(results))\n        \n        collected = phantom.collect2(action_results=results, \n                                     datapath=[\"action\",                                        #0\n                                               \"app\",                                           #1\n                                               \"status\",                                        #2\n                                               \"action_result.summary.total_devices\",           #3 \n                                               \"action_result.data.*.process.total_results\",    #4\n                                               \"action_result.summary.prevalence\",              #5\n                                               \"action_result.summary.device_count\"])           #6\n                                               \n        \n        phantom.debug(collected)        \n\n        for item in collected:\n            ret_item = {}        \n        \n            if item[0] == \"hunt file\" and item[1] == \"CylancePROTECT\" and item[2] == \"success\":\n                if item[3]:\n                    ret_item['bad']= item[3] > 0\n                    ret_data.append(ret_item)\n                    continue    \n                    \n            if item[0] == \"hunt file\" and item[1] == \"Carbon Black\" and item[2] == \"success\":\n                if item[4]:\n                    for count in item[4]:\n                        if ret_item['bad']:  # checking if the value has been set yet\n                            if ret_item['bad'] == False:  # Checking if the threshold has been already met.\n                                ret_item['bad']= count > 0\n                                ret_data.append(ret_item)\n                                continue\n                        else:\n                            ret_item['bad']= count > 0\n                            ret_data.append(ret_item)\n                            continue\n                    \n            if item[0] == \"hunt file\" and item[1] == \"Carbon Black Protection\" and item[2] == \"success\":\n                if item[5]:\n                    ret_item['bad']= item[5] > 0\n                    ret_data.append(ret_item)\n                    continue   \n                    \n            if item[0] == \"hunt file\" and item[1] == \"Falcon Host API\" and item[2] == \"success\":\n                if item[6]:\n                    ret_item['bad']= item[6] > 0\n                    ret_data.append(ret_item)\n                    continue                       \n                    \n            if item[0] == \"hunt domain\" and item[1] == \"Falcon Host API\" and item[2] == \"success\":\n                if item[6]:\n                    ret_item['bad']= item[6] > 0\n                    ret_data.append(ret_item)\n                    continue   \n                    \n    except:\n        phantom.error(\"Exception ocurred in parsing results: {}\".format(traceback.format_exc()))\n        \n    return ret_data     \n\ndef is_bad_ip(results):\n    \n    CAP_KP = 'KP'\n    \n    ret_data=[]\n    \n    try:\n        #phantom.debug(\"ip investigation results: {}\".format(results))\n        \n        collected = phantom.collect2(action_results=results, \n                                     datapath=[\"action\",                                        #0\n                                               \"app\",                                           #1\n                                               \"status\",                                        #2\n                                               \"action_result.summary.country_code\"])           #3\n                                               \n        \n        phantom.debug(collected)        \n\n        for item in collected:\n            ret_item = {}        \n        \n            if item[0] == \"whois ip\" and item[1] == \"Whois\" and item[2] == \"success\":\n                if item[3]:\n                    ret_item['bad']= item[3] == CAP_KP\n                    ret_data.append(ret_item)\n                    continue        \n                    \n    except:\n        phantom.error(\"Exception ocurred in parsing results: {}\".format(traceback.format_exc()))\n        \n    return ret_data        \n\ndef is_positive_query(results):\n    \n    ret_data=[]\n    \n    try:\n        #phantom.debug(\"query results: {}\".format(results))\n        \n        collected = phantom.collect2(action_results=results, \n                                     datapath=[\"action\",                                        #0\n                                               \"app\",                                           #1\n                                               \"status\"])                                       #2\n        \n        phantom.debug(collected)        \n        \n    except:\n        phantom.error(\"Exception ocurred in parsing results: {}\".format(traceback.format_exc()))\n        \n    return ret_data\n\n\n# checks across all hash info providers if the hash is bad or not\ndef is_bad_file(results):\n    \n    BAD_THRESHOLD = 5\n    THREATSCORE_THRESHOLD = 70\n    \n    ret_data=[]\n    \n    try:\n        #phantom.debug(\"hash investigation results: {}\".format(results))\n        \n        collected = phantom.collect2(action_results=results, \n                                     datapath=[\"action\",                                                #0\n                                               \"app\",                                                   #1\n                                               \"status\",                                                #2\n                                               \"action_result.summary.positives\",                       #3\n                                               \"action_result.parameter.hash\",                          #4\n                                               \"action_result.parameter.context.artifact_id\",           #5\n                                               \"action_result.summary.total_positives\",                 #6 Malwr\n                                               \"action_result.data.*.threat.score\",                     #7 Threat Grid\n                                               \"action_result.data.*.report.virustotal.positives\",      #8 Cuckoo   \n                                               \"action_result.data.*.report.malicious_activity.*.type\", #9 Lastline\n                                               \"action_result.summary.malware\"])                        #10 WildFire\n\n        \n        phantom.debug(collected)\n    \n        for item in collected:\n            ret_item = {}\n            ret_item['hash'] = item[4]\n            ret_item['artifact_id'] = item[5]\n\n            if item[0] == \"file reputation\" and item[1] == \"ReversingLabs\" and item[2] == \"success\":\n                if item[3] and item[4] and item[5]:\n                    ret_item['bad']= item[3] > BAD_THRESHOLD\n                    ret_data.append(ret_item)\n                    continue\n                    \n            if item[0] == \"file reputation\" and item[1] == \"VirusTotal\" and item[2] == \"success\":\n                if item[3] and item[4] and item[5]:\n                    ret_item['bad']= item[3] > BAD_THRESHOLD\n                    ret_data.append(ret_item)\n                    continue\n\n            if item[0] == \"detonate file\" and item[1] == \"Malwr\" and item[2] == \"success\":\n                if item[6]:\n                    ret_item['bad']= item[6] > BAD_THRESHOLD\n                    ret_data.append(ret_item)\n                    continue\n\n            if item[0] == \"detonate file\" and item[1] == \"Threat Grid\" and item[2] == \"success\":\n                if item[7]:\n                    for threatscore in item[7]:\n                        if ret_item['bad']: # checking if the value has been set yet\n                            if ret_item['bad'] == False:  # Checking if the threatscore threshold has been already met.\n                                ret_item['bad']= threatscore > THREATSCORE_THRESHOLD\n                                ret_data.append(ret_item)\n                                continue\n                        else:\n                            ret_item['bad']= threatscore > THREATSCORE_THRESHOLD\n                            ret_data.append(ret_item)\n                            continue\n\n            if item[0] == \"detonate file\" and item[1] == \"Cuckoo\" and item[2] == \"success\":\n                if item[8]:\n                    for positives in item[8]:\n                        if ret_item['bad']: # checking if the value has been set yet\n                            if ret_item['bad'] == False:  # Checking if the threatscore threshold has been already met.\n                                ret_item['bad']= positives > BAD_THRESHOLD\n                                ret_data.append(ret_item)\n                                continue\n                        else:\n                            ret_item['bad']= positives > BAD_THRESHOLD\n                            ret_data.append(ret_item)\n                            continue\n\n            if item[0] == \"detonate file\" and item[1] == \"Lastline\" and item[2] == \"success\":\n                if item[9]:\n                    ret_item['bad']= item[9] > THREATSCORE_THRESHOLD\n                    ret_data.append(ret_item)\n                    continue                     \n            \n            if item[0] == \"detonate file\" and item[1] == \"WildFire\" and item[2] == \"success\":\n                if item[10]:\n                    ret_item['bad']= item[10] > THREATSCORE_THRESHOLD\n                    ret_data.append(ret_item)\n                    continue                \n                    \n    except:\n        phantom.error(\"Exception ocurred in parsing results: {}\".format(traceback.format_exc()))\n        \n    return ret_data", "clean": true}}, "create_time": "2016-09-20T06:11:42.873907+00:00"}
